_G["ESX"],_G["xPlayer"],_G["source"],_G["developer"]=nil,{},GetPlayerServerId(PlayerId()),function()end;local a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t=AddTextEntry,BeginTextCommandDisplayHelp,EndTextCommandDisplayHelp,SetNotificationTextEntry,AddTextComponentSubstringPlayerName,DrawNotification,GetEntityCoords,World3dToScreen2d,SetTextScale,SetTextFont,SetTextEntry,SetTextCentre,AddTextComponentString,DrawText,DoesEntityExist,GetDistanceBetweenCoords,GetPlayerPed,TriggerEvent,TriggerServerEvent;local u=GetCurrentResourceName()local v={["ESC"]=322,["F1"]=288,["F2"]=289,["F3"]=170,["F5"]=166,["F6"]=167,["F7"]=168,["F8"]=169,["F9"]=56,["F10"]=57,["~"]=243,["1"]=157,["2"]=158,["3"]=160,["4"]=164,["5"]=165,["6"]=159,["7"]=161,["8"]=162,["9"]=163,["-"]=84,["="]=83,["BACKSPACE"]=177,["TAB"]=37,["Q"]=44,["W"]=32,["E"]=38,["R"]=45,["T"]=245,["Y"]=246,["U"]=303,["P"]=199,["["]=39,["]"]=40,["ENTER"]=18,["CAPS"]=137,["A"]=34,["S"]=8,["D"]=9,["F"]=23,["G"]=47,["H"]=74,["K"]=311,["L"]=182,["LEFTSHIFT"]=21,["Z"]=20,["X"]=73,["C"]=26,["V"]=0,["B"]=29,["N"]=249,["M"]=244,[","]=82,["."]=81,["LEFTCTRL"]=36,["LEFTALT"]=19,["SPACE"]=22,["RIGHTCTRL"]=70,["HOME"]=213,["PAGEUP"]=10,["PAGEDOWN"]=11,["DELETE"]=178,["LEFT"]=174,["RIGHT"]=175,["TOP"]=27,["DOWN"]=173,["NENTER"]=201,["N4"]=108,["N5"]=60,["N6"]=107,["N+"]=96,["N-"]=97,["N7"]=117,["N8"]=61,["N9"]=118}_G["Utility"]={Cache={PlayerPedId=PlayerPedId(),Marker={},Object={},Dialogue={},N3d={},Emitter={},SetData={},Frozen={},FlowDetector={},Constant={},Loop={}}}On=function(type,w,x)if string.find(type,"_change")then type=type..source end;local y={res=u,a=w,b=x}s("Utility:Create","Emitter",type,y,u)end;_G.old_TaskVehicleDriveToCoord=TaskVehicleDriveToCoord;TaskVehicleDriveToCoord=function(z,A,B,C,D)old_TaskVehicleDriveToCoord(z,A,B,C or 10.0,0,GetEntityModel(A),2883621,D or 1.0)end;_G.old_DisableControlAction=DisableControlAction;DisableControlAction=function(E,F)return old_DisableControlAction(0,v[string.upper(E)],true or F)end;DisableControlForSeconds=function(E,G)local H=G;Citizen.CreateThread(function()while H>0 do Citizen.Wait(1000)H=H-1 end;return end)Citizen.CreateThread(function()while H>0 do DisableControlAction(v[string.upper(E)])Citizen.Wait(1)end;return end)end;_G.old_IsControlJustPressed=IsControlJustPressed;IsControlJustPressed=function(I,J)developer("^2Created^0","key map",I)RegisterKeyMapping('utility '..I,'',"keyboard",I)AddEventHandler("Utility:Pressed_"..I,J)end;ShowNotification=function(K)d('STRING')e(K)f(false,true)end;ButtonNotification=function(K)if string.match(K,"{.*}")then K=string.multigsub(K,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})end;a('ButtonNotification',K)b('ButtonNotification')c(0,false,true,-1)end;FloatingNotification=function(K,L)a('FloatingNotification',K)SetFloatingHelpTextWorldPosition(1,L)SetFloatingHelpTextStyle(1,1,2,-1,3,0)b('FloatingNotification')c(2,false,false,-1)end;MakeEntityFaceEntity=function(M,N,O)local P=g(M,true)local Q=g(N,true)if O then local R=GetHeadingFromVector_2d(Q.x-P.x,Q.y-P.y)SetEntityHeading(M,R)else local R=GetHeadingFromVector_2d(P.x-Q.x,P.y-Q.y)SetEntityHeading(N,R)end end;DrawText3Ds=function(L,S,T,U,V)local W,X,Y=h(L.x,L.y,L.z)if W then i(T or 0.35,T or 0.35)j(U or 4)k("STRING")l(1)m(S)o(X,Y)if V then local Z=string.len(S)/370;local _,a0=string.gsub(Z,"\n","\n")*0.025;if a0==nil then a0=0 end;DrawRect(X,Y+0.0125,0.025+Z,0.025+a0,0,0,0,90)end end end;_G.old_TaskPlayAnim=TaskPlayAnim;TaskPlayAnim=function(z,a1,...)if not HasAnimDictLoaded(a1)then RequestAnimDict(a1)while not HasAnimDictLoaded(a1)do Citizen.Wait(1)end end;old_TaskPlayAnim(z,a1,...)RemoveAnimDict(a1)end;_G.old_CreateObject=CreateObject;CreateObject=function(a2,...)if type(a2)=="string"then a2=GetHashKey(a2)end;if not HasModelLoaded(a2)then RequestModel(a2)while not HasModelLoaded(a2)do Citizen.Wait(1)end end;local a3=old_CreateObject(a2,...)SetModelAsNoLongerNeeded(a2)local a4=0;if NetworkGetEntityIsNetworked(a3)then a4=ObjToNet(a3)SetNetworkIdExistsOnAllMachines(a4,true)SetNetworkIdCanMigrate(a4,true)end;return a3,a4 end;_G.old_CreatePed=CreatePed;CreatePed=function(a2,...)if type(a2)=="string"then a2=GetHashKey(a2)end;if not HasModelLoaded(a2)then RequestModel(a2)while not HasModelLoaded(a2)do Citizen.Wait(1)end end;local z=old_CreatePed(0,a2,...)SetModelAsNoLongerNeeded(a2)local a4=0;if NetworkGetEntityIsNetworked(z)then a4=PedToNet(z)SetNetworkIdExistsOnAllMachines(a4,true)SetNetworkIdCanMigrate(a4,true)end;return z,a4 end;_G.old_CreateVehicle=CreateVehicle;CreateVehicle=function(a2,...)if type(a2)=="string"then a2=GetHashKey(a2)end;if not HasModelLoaded(a2)then RequestModel(a2)while not HasModelLoaded(a2)do Citizen.Wait(1)end end;local a5=old_CreateVehicle(a2,...)SetModelAsNoLongerNeeded(a2)local a4=0;if NetworkGetEntityIsNetworked(a5)then a4=VehToNet(a5)SetNetworkIdExistsOnAllMachines(a4,true)SetNetworkIdCanMigrate(a4,true)end;return a5,a4 end;_G.old_DeleteEntity=DeleteEntity;DeleteEntity=function(a6,a7)if not a7 then NetworkRequestControlOfEntity(a6)while not NetworkRequestControlOfEntity(a6)do Citizen.Wait(1)end;if not IsEntityAMissionEntity(a6)then SetEntityAsMissionEntity(a6)end;old_DeleteEntity(a6)else NetworkRequestControlOfNetworkId(a6)local a8=NetworkGetEntityFromNetworkId(a6)while not NetworkRequestControlOfEntity(a8)do Citizen.Wait(1)end;SetEntityAsMissionEntity(a8)old_DeleteEntity(a8)end end;_G.old_RegisterNetEvent=RegisterNetEvent;RegisterNetEvent=function(a9,aa)old_RegisterNetEvent(a9)AddEventHandler(a9,aa)end;_G.old_GetPlayerName=GetPlayerName;GetPlayerName=function(ab)return old_GetPlayerName(ab or PlayerId())end;_G.old_PlayerPedId=PlayerPedId;PlayerPedId=function()if not p(Utility.Cache.PlayerPedId)then Utility.Cache.PlayerPedId=old_PlayerPedId()end;return Utility.Cache.PlayerPedId end;_break=function(ab)Utility.Cache.Loop[ab]=nil end;LoopThread=function(ac,ab,ad,ae)if Utility.Cache.Loop[ac]==nil then developer("^1Error^0","You dont have inserted the thread id or the thread id dont exist!")return nil end;if Utility.Cache.Loop[ac].Thread[ab]==nil then Utility.Cache.Loop[ac].Thread[ab]={a=true,b=false}end;if Utility.Cache.Loop[ac].Thread[ab].a then if not Utility.Cache.Loop[ac].Thread[ab].b then Utility.Cache.Loop[ac].Thread[ab].b=true;Citizen.SetTimeout(ad,function()ae()Utility.Cache.Loop[ac].Thread[ab].b=false end)end end end;StopLoopThread=function(ac,ab)Utility.Cache.Loop[ac].Thread[ab].a=false end;ResumeLoopThread=function(ac,ab)Utility.Cache.Loop[ac].Thread[ab].a=true end;TaskBack=function(af,ab,ae)LoopThread(af,ab,5000,function()ae()end)end;TaskSlow=function(af,ab,ae)LoopThread(af,ab,1000,function()ae()end)end;TaskFast=function(af,ab,ae)LoopThread(af,ab,500,function()ae()end)end;TaskExtrafast=function(af,ab,ae)LoopThread(af,ab,5,function()ae()end)end;CreateLoop=function(J,ag)local af=RandomId(5)Utility.Cache.Loop[af]={Thread={}}Citizen.CreateThread(function()while Utility.Cache.Loop[af]~=nil do J(af)Citizen.Wait(ag or 5)end end)end;GetWorldClosestPed=function(ah)local ai=0;local aj=GetGamePool("CPed")local L=g(PlayerPedId())local ak=ah+5.0;for al=1,#aj do local am=q(L,g(aj[al]),false)if am<=ah and aj[al]~=PlayerPedId()then if ak>am then ak=am;ai=aj[al]end end end;return ai,aj end;GetWorldClosestPlayer=function(ah)local ai=0;local an={}local ak=ah+5.0;local aj=GetGamePool("CPed")local L=g(PlayerPedId())for al=1,#aj do if IsPedAPlayer(aj[al])then table.insert(an,NetworkGetPlayerIndexFromPed(aj[al]))local am=q(L,g(aj[al]),false)if am<=ah and aj[al]~=PlayerPedId()then if ak>am then ak=am;ai=NetworkGetPlayerIndexFromPed(aj[al])end end end end;return ai,an end;GetEntitySurfaceMaterial=function(a6)local L=GetEntityCoords(a6)local ao=StartShapeTestCapsule(L.x,L.y,L.z,L.x,L.y,L.z-2.5,2,1,a6,7)local _,ap,_,_,aq=GetShapeTestResultIncludingMaterial(ao)return aq,ap end;GetLoadoutOfPed=function(z)local ar=ESX.GetWeaponList()local as={}for al=1,#ar,1 do local hash=GetHashKey(ar.name)if HasPedGotWeapon(z,hash,false)then table.insert(as,{name=ar.name,hash=hash,ammo=GetAmmoInPedWeapon(z,hash)})end end;return as end;local at=FreezeEntityPosition;FreezeEntityPosition=function(a6,au)Utility.Cache.Frozen[a6]=au;at(a6,au)end;IsEntityFrozen=function(a6)return Utility.Cache.Frozen[a6]==true end;GetNearestValue=function(av,aw)local ax=100*100000000000;local ay=0;for al=1,#aw do local az=math.abs(aw[al]-av)if az<ax then ax=az;n=aw[al]ay=al end end;return n,ax,ay end;TriggerSyncedEvent=function(aA,aB,...)if type(aB)=="number"or type(aB)=="table"then if aB==-1 then t("Utility:SyncEvent",aA,"",...)else t("Utility:SyncEvent",aA,aB,...)end else developer("^1Error^0","you can use only number/table on whitelist of TriggerSyncedEvent","")end end;StartESX=function(a9,aC)Citizen.CreateThreadNow(function()while ESX==nil do TriggerEvent(a9 or'esx:getSharedObject',function(a3)ESX=a3 end)Citizen.Wait(1)end;while ESX.GetPlayerData().job==nil do Citizen.Wait(1)end;xPlayer=ESX.GetPlayerData()if aC~=nil then while ESX.GetPlayerData()[aC]==nil do Citizen.Wait(1)end;xPlayer=ESX.GetPlayerData()end;if aC~=nil then RegisterNetEvent('esx:set'..string.upper(aC:sub(1,1))..aC:sub(2),function(aD)xPlayer[aC]=aD end)end;RegisterNetEvent('esx:setJob',function(aD)xPlayer.job=aD end)end)end;GetDataForJob=function(aD)if ESX==nil then developer("^1Error^0","ESX dont loaded, retry","")return end;local aE=nil;ESX.TriggerServerCallback("Utility:GetJobData",function(aF)aE=aF end,aD)while aE==nil do Citizen.Wait(1)end;return#aE,aE end;local aG=0;GetOnHandObject=function()return aG end;TakeObjectOnHand=function(z,aH,aI,aJ,aK,aL,aM,aN,aO)developer("^2Taking^0","object",aH.." ("..GetEntityModel(aH)..")")if type(aH)=="number"then TaskPlayAnim(z,"anim@heists@box_carry@","idle",3.0,3.0,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aH,z,GetPedBoneIndex(z,60309),aJ or 0.2,aK or 0.08,aL or 0.2,aM or-45.0,aN or 290.0,aO or 0.0,true,true,false,true,1,true)aG=aH elseif type(aH)=="string"then local L=g(z)local aP=CreateObject(aH,L+vector3(0.0,0.0,aI or 0.2),true,false,false)SetEntityAsMissionEntity(aP)TaskPlayAnim(z,"anim@heists@box_carry@","idle",3.0,-8,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aP,z,GetPedBoneIndex(z,60309),aJ or 0.2,aK or 0.08,aL or 0.2,aM or-45.0,aN or 290.0,aO or 0.0,true,true,false,true,1,true)aG=aP;return aP end end;DropObjectFromHand=function(aQ,aR)if aR then developer("^1Deleting^0","from hand",aQ)DeleteEntity(aQ)else developer("^3Dont delete^0","from hand",aQ)DetachEntity(aQ)SetEntityCoords(aQ,GetOffsetFromEntityInWorldCoords(aQ,0,0.5,0))PlaceObjectOnGroundProperly(aQ)FreezeEntityPosition(aQ,true)end;ClearPedTasks(PlayerPedId())aG=0 end;IsInRadius=function(P,Q,ah,aS)local am=#(P-Q)if aS then DrawSphere(Q,ah,255,0,0,0.5)end;return am<ah end;IsNearCoords=function(L,ah,aS)local am=#(GetEntityCoords(PlayerPedId())-L)if aS then DrawSphere(L,ah,255,0,0,0.5)end;return am<ah end;GenerateRandomCoords=function(L,ah,R)local aT=L.x+math.random(-ah,ah)local aU=L.y+math.random(-ah,ah)local _,aV=GetGroundZFor_3dCoord(aT,aU,200.0,0)if R then return vector3(aT,aU,aV),math.random(0.0,360.0)end;return vector3(aT,aU,aV)end;SetFor=function(ab,aW,aX)if Utility.Cache["SetData"][ab]==nil then Utility.Cache["SetData"][ab]={}end;if type(aW)=="table"then for aY,av in pairs(aW)do developer("^2Setting^0","data","("..ab..") ["..aY.." = "..json.encode(av).."] {table}")Utility.Cache["SetData"][ab][aY]=av end else developer("^2Setting^0","data","("..ab..") ["..aW.." = "..json.encode(aX).."] {single}")Utility.Cache["SetData"][ab][aW]=aX end end;GetFrom=function(ab,aW)if aW==nil then aW="not defined"end;developer("^3Getting^0","data","("..ab..") ["..aW.."]")if Utility.Cache["SetData"][ab]~=nil then if aW=="not defined"then return Utility.Cache["SetData"][ab]else return Utility.Cache["SetData"][ab][aW]end else return nil end end;RandomId=function(aZ)aZ=aZ or 5;local a_=""for al=1,aZ do a_=a_.."9"end;return math.random(0,a_)end;CreateMarker=function(ab,L,b0,b1,b2)if DoesExist("m",ab)then Citizen.Wait(100)return else if type(L)~="vector3"then developer("^1Error^0","You can use only vector3 for coords!",ab)return end;ab=string.gsub(ab,"{r}",RandomId())developer("^2Created^0","Marker",ab)local b3={render_distance=b0,interaction_distance=b1,coords=L}if type(b2)=="table"then if b2.rgb~=nil then b3.type=1;b3.rgb=b2.rgb elseif b2.text~=nil then b3.type=0;b3.text=b2.text;s("Utility:Create","Marker",ab,b3)return else b3.type=1;b3.rgb={b2[1],b2[2],b2[3]}s("Utility:Create","Marker",ab,b3)return end;if b2.type~=nil and type(b2.type)=="number"then b3._type=b2.type end;if b2.direction~=nil and type(b2.direction)=="vector3"then b3._direction=b2.direction end;if b2.rotation~=nil and type(b2.rotation)=="vector3"then b3._rot=b2.rotation end;if b2.scale~=nil and type(b2.scale)=="vector3"then b3._scale=b2.scale end;if b2.alpha~=nil and type(b2.alpha)=="number"then b3.alpha=b2.alpha end;if b2.animation~=nil and type(b2.animation)=="boolean"then b3.anim=b2.animation end;if b2.notify~=nil then local b4=string.multigsub(b2.notify,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})b3.notify=b4 end elseif type(b2)=="string"then b3.type=0;b3.text=b2 end;Utility.Cache.Marker[ab]=b3;s("Utility:Create","Marker",ab,b3)end end;SetMarkerType=function(ab,b5)if type(b5)~="number"then developer("^1Error^0","Type can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._type=b5;s("Utility:Edit","Marker",ab,"_type",b5)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerDirection=function(ab,b6)if type(b6)~="vector3"then developer("^1Error^0","Direction can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._direction=b6;s("Utility:Edit","Marker",ab,"_direction",b6)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerRotation=function(ab,b7)if type(b7)~="vector3"then developer("^1Error^0","Rotation can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._rot=b7;s("Utility:Edit","Marker",ab,"_rot",b7)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerScale=function(ab,T)if type(T)~="vector3"then developer("^1Error^0","Scale can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._scale=T;s("Utility:Edit","Marker",ab,"_scale",T)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerColor=function(ab,b8)if type(b8)~="table"then developer("^1Error^0","Color can be only a vector3","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].rgb=b8;s("Utility:Edit","Marker",ab,"rgb",b8)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerAlpha=function(ab,b9)if type(b9)~="number"then developer("^1Error^0","Alpha can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].alpha=b9;s("Utility:Edit","Marker",ab,"alpha",b9)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerAnimation=function(ab,au)if type(au)~="boolean"then developer("^1Error  ^0","Animation can be only a boolean (true/false)","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].anim=au;s("Utility:Edit","Marker",ab,"anim",au)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;SetMarkerDrawOnEntity=function(ab,au)if type(au)~="boolean"then developer("^1Error^0","Draw on entity can be only a boolean (true/false)","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].draw_entity=au;s("Utility:Edit","Marker",ab,"draw_entity",au)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;Set3dTextScale=function(ab,T)if type(T)~="number"then developer("^1Error^0","Marker scale can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab]._scale=T;s("Utility:Edit","Marker",ab,"_scale",T)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;Set3dTextDrawRect=function(ab,au)if type(au)~="boolean"then developer("^1Error^0","Marker rect can be only a boolean (true/false)","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].rect=au;s("Utility:Edit","Marker",ab,"rect",au)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;Set3dTextFont=function(ab,U)if type(U)~="number"then developer("^1Error^0","Marker font can be only a number","[Marker]")return end;if DoesExist("marker",ab)then Utility.Cache.Marker[ab].font=U;s("Utility:Edit","Marker",ab,"font",U)else developer("^1Error^0","Unable to edit the marker as it does not exist",ab)end end;DeleteMarker=function(ab)if not DoesExist("m",ab)then Citizen.Wait(100)return else developer("^1Deleted^0","Marker",ab)Utility.Cache.Marker[ab]=nil;s("Utility:Remove","Marker",ab)end end;CreateiObject=function(ab,ba,bb,R,b1,bc)developer("^2Created^0 Object "..ab.." ("..ba..")")local a3=CreateObject(GetHashKey(ba),bb.x,bb.y,bb.z,bc or true,false,false)or nil;SetEntityHeading(a3,R)SetEntityAsMissionEntity(a3,true,true)FreezeEntityPosition(a3,true)SetModelAsNoLongerNeeded(hash)_object={obj=a3,coords=bb,interaction_distance=b1 or 3.0}Utility.Cache.Object[ab]=_object;s("Utility:Create","Object",ab,_object)return a3,g(a3)end;DeleteiObject=function(ab,aR)developer("^1Deleted^0","Object",ab)if aR then DeleteEntity(Utility.Cache.Object[ab].obj)end;Utility.Cache.Object[ab]=nil;s("Utility:Remove","Object",ab)end;CreateBlip=function(bd,L,be,bf,T)developer("^2Created^0","Blip",bd)local bg=AddBlipForCoord(L)SetBlipSprite(bg,be)SetBlipScale(bg,T or 1.0)SetBlipColour(bg,bf)SetBlipAsShortRange(bg,true)BeginTextCommandSetBlipName('STRING')e(bd)EndTextCommandSetBlipName(bg)return bg end;SetIdOf=function(type,ab,bh)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ab)then Utility.Cache[type][bh]=Utility.Cache[type][ab]Utility.Cache[type][ab]=nil else developer("^1Error^0","Unable to set id of the "..type.." as it does not exist",ab)return end;developer("^3Change^0","Setted id to "..bh.." of the id",ab)s("Utility:Remove",type,ab)s("Utility:Create",type,bh,Utility.Cache[type][bh])end;SetTextOf=function(type,ab,bi)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ab)then Utility.Cache[type][ab].text=bi;s("Utility:Edit",type,ab,"text",bi)else developer("^1Error^0","Unable to change text of the "..type.." as it does not exist",ab)return end;developer("^3Change^0","Setted text to "..bi.." of the id",ab)end;GetDistanceFrom=function(type,ab)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;local am=0.0;if Utility.Cache[type][ab].coords~=nil then return q(g(PlayerPedId()),Utility.Cache[type][ab].coords,true)else return false end end;GetCoordOf=function(type,ab)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ab)then return Utility.Cache[type][ab].coords else developer("^1Error^0","Unable to get the coords of the id",ab)return false end end;DoesExist=function(type,ab)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if Utility.Cache[type][ab]~=nil then return true else return false end end;CreateCamera=function(L,bj,au,bk)local bl=CreateCam("DEFAULT_SCRIPTED_CAMERA",true)SetCamCoord(bl,L)if bj~=nil then SetCamRot(bl,bj.x,bj.y,bj.z)end;if bk~=nil then ShakeCam(bl,bk.type or"",bk.amount or 0.0)end;if au then SetCamActive(bl,true)RenderScriptCams(1,1,1500,1,1)end;return bl end;SwitchBetweenCam=function(bm,bl)SetCamActiveWithInterp(bl,bm,1500,1,1)Citizen.Wait(1600)DestroyCam(bm)end;DevMode=function(bn,ad,bo)if ad==nil then ad=true end;bo=bo or"%s %s %s"if bn then developer=function(bp,type,ab)local _,_,_,bq,br,bs=GetLocalTime()if ad then if type==nil then print(bq..":"..br..":"..bs.." - "..bp)else print(bq..":"..br..":"..bs.." - "..string.format(bo,bp,type,ab))end else if type==nil then print(bp)else print(string.format(bo,bp,type,ab))end end end else developer=function()end end end;ReplaceTexture=function(aP,bt,bu,bv,bw)local bx=CreateRuntimeTxd('duiTxd')local by=CreateDui(bu,bv,bw)local bz=GetDuiHandle(by)local bA=CreateRuntimeTextureFromDuiHandle(bx,'duiTex',bz)AddReplaceTexture(aP,bt,'duiTxd','duiTex')end;printd=function(bB,bC)if bC then local bD={}local function bE(bF,bG)if bD[tostring(bF)]then print(bG.."*"..tostring(bF))else bD[tostring(bF)]=true;if type(bF)=="table"then for bb,bH in pairs(bF)do if type(bH)=="table"then print(bG.."["..bb.."] => "..tostring(bF).." {")bE(bH,bG..string.rep(" ",string.len(bb)+8))print(bG..string.rep(" ",string.len(bb)+6).."}")elseif type(bH)=="string"then print(bG.."["..bb.."] => \""..bH.."\"")else print(bG.."["..bb.."] => "..tostring(bH))end end else print(bG..tostring(bF))end end end;if type(bB)=="table"then print(tostring(bB).." {")bE(bB,"  ")print("}")else developer("^1Error^0","error dumping table "..bB.." why isnt a table","")end else if type(bB)=="table"then print(json.encode(bB,{indent=true}))else developer("^1Error^0","error dumping table "..bB.." why isnt a table","")end end end;local bI=string.gsub;string.multigsub=function(string,table,bJ)if type(table)then for al=1,#table do string=bI(string,table[al],bJ[al])end else for al=1,#table do string=bI(string,table[al],bJ)end end;return string end;table.fexist=function(bB,bK)bB=bB[bK]if not bB then return false else return true end end;local bL=table.remove;table.remove=function(bB,bM,bN)if type(bM)=="number"then bL(bB,bM)elseif type(bM)=="string"then for aY,av in pairs(bB)do if aY==bM then bB[aY]=nil;if bN then break end end end end end;table.empty=function(bB)return next(bB)==nil end;table.clone=function(bB)bB.metatable={__index=bB}local bO={}setmetatable(bO,bB.metatable)return bO end;local function bP(a6,_dialog,bQ)return{Question=function(...)local bR={...}_dialog.questions=bR;return{Response=function(...)local bS={}local bT={}for bU,bV in pairs({...})do bT[bU]={}for aY,av in pairs(bV)do if bS[bU]==nil then bS[bU]=""end;bS[bU]=bS[bU]..aY.."~w~ "..av.." | "aY=string.multigsub(aY,{"%[","%]"},{"",""})aY=string.multigsub(aY,{"~r~","~b~","~g~","~y~","~p~","~o~","~c~","~m~","~u~","~n~","~s~","~w~"},{"","","","","","","","","","","",""})bT[bU][aY]=av end;bS[bU]=bS[bU]:sub(1,-3)end;_dialog.response={no_formatted=bT,formatted=bS}if bQ then s("Utility:Remove","Dialogue",a6)s("Utility:Create","Dialogue",a6,_dialog)else s("Utility:Create","Dialogue",a6,_dialog)end;Utility.Cache.Dialogue[a6]=_dialog;return{LastQuestion=function(bW)Utility.Cache.Dialogue[a6].lastq=bW;s("Utility:Edit","Dialogue",a6,"lastq",bW)end}end}end}end;StartDialogue=function(a6,am,bX)local _dialog={}_dialog={entity=a6,distance=am,current_question=1,callback=bX}developer("^2Created^0","dialogue with entity",a6)return bP(a6,_dialog)end;EditDialogue=function(a6)if a6~=nil and IsEntityOnDialogue(a6)then return bP(a6,_dialog,true)end end;StopDialogue=function(a6)if a6~=nil and IsEntityOnDialogue(a6)then developer("^1Stopping^0","dialogue",a6)if Utility.Cache.Dialogue[a6].lastq~=nil then local bY=0;local bZ=Utility.Cache.Dialogue[a6].lastq;local b_=Utility.Cache.Dialogue[a6].entity;local c0=GetEntityCoords(b_)+vector3(0.0,0.0,1.0)CreateLoop(function(af)LoopThread(af,1000,function()c0=GetEntityCoords(b_)+vector3(0.0,0.0,1.0)bY=bY+1 end)if bY==3 then _break(af)end;DrawText3Ds(c0,bZ,nil,nil,true)end)end;Utility.Cache.Dialogue[a6]=nil;s("Utility:Remove","Dialogue",a6)end end;RegisterNetEvent("Utility_Native:ResyncDialogue",function(a6)Utility.Cache.Dialogue[a6]=nil end)IsEntityOnDialogue=function(a6)return Utility.Cache.Dialogue[a6]end;local function c1(table)local c2={}print("Copying table "..tostring(table))for aY,av in pairs(table)do c2[aY]=av end;return c2 end;CreateLoop(function()for bd,c3 in pairs(Utility.Cache.FlowDetector)do local c4=_G[bd]if type(c4)=='table'or type(c3)=='table'then if json.encode(c3)~=json.encode(c4)then print("\nDetected old_value change of syncedV \""..bd.."\" from \""..json.encode(c3).."\" to \""..json.encode(c4).."\"")TriggerSyncedEvent("Utility:SyncValue_emit",-1,bd,c3,c4)TriggerSyncedEvent("Utility:SyncValue["..u.."]",-1,bd,c4)local c2=c1(c4)Utility.Cache.FlowDetector[bd]=c2 end else if c4~=c3 then TriggerSyncedEvent("Utility:SyncValue_emit",-1,bd,c3,c4)TriggerSyncedEvent("Utility:SyncValue["..u.."]",-1,bd,c4)Utility.Cache.FlowDetector[bd]=c4 end end end end,2000)Synced=function(bd,aX)print("Creating synceV "..bd)if type(aX)=="table"then local c2=c1(aX)Utility.Cache.FlowDetector[bd]=c2;_G[bd]=aX else Utility.Cache.FlowDetector[bd]=aX;_G[bd]=aX end end;RegisterNetEvent("Utility:SyncValue["..u.."]",function(bd,aX)_G[bd]=aX end)local function c5(c6,c7)local c8=RequestScaleformMovie(c7)local bY=100;while not HasScaleformMovieLoaded(c8)and bY>0 do bY=bY-1;c8=RequestScaleformMovie(c7)Citizen.Wait(5)end;if bY==0 then developer("^1Error^0","After 100 attempts to load the scaleform the scaleform has not loaded yet, try again or check that it has started correctly!","")return end;Utility.Cache.N3d[c6].scaleform=c8;s("Utility:Edit","N3d",c6,"scaleform",c8)end;local function c9(c6,bu,bv,bw)local bx=CreateRuntimeTxd('txd')Utility.Cache.N3d[c6].dui=CreateDui(bu,bv,bw)s("Utility:Edit","N3d",c6,"dui",Utility.Cache.N3d[c6].dui)local bz=GetDuiHandle(Utility.Cache.N3d[c6].dui)CreateRuntimeTextureFromDuiHandle(bx,'txn',bz)if Utility.Cache.N3d[c6].scaleform~=nil and not Utility.Cache.N3d[c6].txd then PushScaleformMovieFunction(Utility.Cache.N3d[c6].scaleform,'SET_TEXTURE')PushScaleformMovieMethodParameterString('txd')PushScaleformMovieMethodParameterString('txn')PushScaleformMovieFunctionParameterInt(0)PushScaleformMovieFunctionParameterInt(0)PushScaleformMovieFunctionParameterInt(bv)PushScaleformMovieFunctionParameterInt(bw)PopScaleformMovieFunctionVoid()Utility.Cache.N3d[c6].txd=true;s("Utility:Edit","N3d",c6,"txd",true)end end;function CreateNui3d(ca,bu)local c6=tostring(math.random(0,9999))local cb={txd=false,show=false,rotation={}}Utility.Cache.N3d[c6]=cb;s("Utility:Create","N3d",c6,cb)c5(c6,ca)if bu~=nil then c9(c6,"nui://"..GetCurrentResourceName().."/"..bu,1920,1080)end;local cc={}cc.__index=cc;cc.init=function(self,bu,bv,bw)c9(c6,"nui://"..GetCurrentResourceName().."/"..bu,bv or 1920,bw or 1080)end;cc.scale=function(self,T)Utility.Cache.N3d[c6].advanced_scale=T;s("Utility:Edit","N3d",c6,"advanced_scale",T)end;cc.rotation=function(self,bj,cd)Utility.Cache.N3d[c6].rotation.rotation=bj;Utility.Cache.N3d[c6].rotation.syncedwithplayer=cd;s("Utility:Edit","N3d",c6,"rotation",{rotation=bj,syncedwithplayer=cd})end;cc.destroy=function(self)if Utility.Cache.N3d[c6].dui~=nil then DestroyDui(Utility.Cache.N3d[c6].dui)SetScaleformMovieAsNoLongerNeeded(ca)s("Utility:Remove","N3d",c6)end end;cc.started=function()return Utility.Cache.N3d[c6].dui~=nil end;cc.show=function(self,L,T)Utility.Cache.N3d[c6].coords=L;Utility.Cache.N3d[c6].scale=T or 0.1;Utility.Cache.N3d[c6].show=true;s("Utility:Edit","N3d",c6,"coords",L)s("Utility:Edit","N3d",c6,"scale",T or 0.1)s("Utility:Edit","N3d",c6,"show",true)end;cc.visible=function()return Utility.Cache.N3d[c6].show end;cc.hide=function()Utility.Cache.N3d[c6].show=false;s("Utility:Edit","N3d",c6,"show",false)end;cc.attach=function(self,a6,ce)Utility.Cache.N3d[c6].attach={entity=a6,offset=ce or vector3(0.0,0.0,0.0)}s("Utility:Edit","N3d",c6,"attach",{entity=a6,offset=ce or vector3(0.0,0.0,0.0)})end;cc.detach=function(self,cf)if cf then Utility.Cache.N3d[c6].coords=GetEntityCoords(Utility.Cache.N3d[c6].attach.entity)s("Utility:Edit","N3d",c6,"coords",Utility.Cache.N3d[c6].coords)end;Utility.Cache.N3d[c6].attach=nil;s("Utility:Edit","N3d",c6,"attach",nil)end;cc.object=function()return Utility.Cache.N3d[c6].dui end;cc.msg=function(self,K)if self:started()then SendDuiMessage(self:object(),json.encode(K))end end;return setmetatable({},cc)end;AddEventHandler("onResourceStop",function(cg)if cg==u then for ch,ci in pairs(Utility.Cache.N3d)do if ci.dui~=nil then if IsDuiAvailable(ci.dui)then DestroyDui(ci.dui)s("Utility:Remove","N3d",ch)end end end end end)